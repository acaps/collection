<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Collection</title>
  <style>
    :root{
      /* ChatGPT-ish neutrals + subtle green accent */
      --bg: #0b0f14;
      --paper: #0f141a;
      --card: rgba(255,255,255,0.06);
      --card2: rgba(255,255,255,0.08);
      --stroke: rgba(255,255,255,0.10);
      --stroke2: rgba(255,255,255,0.14);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --faint: rgba(255,255,255,0.52);
      --accent: #19c37d; /* ChatGPT green-ish */
      --accent2: rgba(25,195,125,0.18);
      --shadow: 0 14px 40px rgba(0,0,0,0.45);
      --shadow2: 0 10px 28px rgba(0,0,0,0.35);
      --radius: 18px;
      --radius2: 26px;
      --max: 1040px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --serif: ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
    }

    @media (prefers-color-scheme: light) {
      :root{
        --bg: #f6f7f8;
        --paper: #ffffff;
        --card: rgba(17,24,39,0.04);
        --card2: rgba(17,24,39,0.06);
        --stroke: rgba(17,24,39,0.10);
        --stroke2: rgba(17,24,39,0.14);
        --text: rgba(17,24,39,0.92);
        --muted: rgba(17,24,39,0.70);
        --faint: rgba(17,24,39,0.52);
        --shadow: 0 18px 45px rgba(17,24,39,0.08);
        --shadow2: 0 12px 28px rgba(17,24,39,0.06);
      }
    }

    *{ box-sizing: border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:
        radial-gradient(1200px 800px at 10% -10%, rgba(25,195,125,0.10), transparent 60%),
        radial-gradient(900px 700px at 90% 20%, rgba(25,195,125,0.08), transparent 55%),
        radial-gradient(1100px 900px at 50% 110%, rgba(255,255,255,0.06), transparent 60%),
        var(--bg);
      color: var(--text);
      font-family: var(--sans);
      letter-spacing: 0.2px;
    }

    a{ color: inherit; text-decoration: none; }
    button, input{ font-family: inherit; }

    /* Top nav */
    .topbar{
      position: sticky;
      top:0;
      z-index: 20;
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      background: linear-gradient(to bottom, rgba(0,0,0,0.35), rgba(0,0,0,0.15));
      border-bottom: 1px solid var(--stroke);
    }
    @media (prefers-color-scheme: light) {
      .topbar{
        background: linear-gradient(to bottom, rgba(255,255,255,0.92), rgba(255,255,255,0.70));
      }
    }
    .topbar-inner{
      max-width: var(--max);
      margin: 0 auto;
      padding: 14px 18px;
      display:flex;
      align-items:center;
      gap: 14px;
    }

    .brand{
      display:flex;
      align-items: baseline;
      gap: 10px;
      min-width: 220px;
    }
    .brand-mark{
      width: 36px;
      height: 36px;
      border-radius: 12px;
      background:
        radial-gradient(16px 16px at 28% 30%, rgba(255,255,255,0.55), transparent 60%),
        radial-gradient(22px 22px at 70% 75%, rgba(25,195,125,0.55), transparent 60%),
        linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.02));
      border: 1px solid var(--stroke2);
      box-shadow: var(--shadow2);
      position: relative;
      overflow: hidden;
    }
    .brand-mark:after{
      content:"";
      position:absolute;
      inset:-40%;
      background: conic-gradient(from 180deg, rgba(25,195,125,0.0), rgba(25,195,125,0.25), rgba(255,255,255,0.0));
      animation: spin 10s linear infinite;
      filter: blur(10px);
      opacity: 0.75;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .brand-name{
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.6px;
      text-transform: uppercase;
    }
    .brand-sub{
      font-size: 12px;
      color: var(--faint);
      font-family: var(--mono);
      transform: translateY(-1px);
    }

    .search{
      flex:1;
      display:flex;
      align-items:center;
      gap: 10px;
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: 999px;
      padding: 10px 12px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
    }
    .search svg{ opacity: 0.7; }
    .search input{
      border:0;
      outline:none;
      width:100%;
      background: transparent;
      color: var(--text);
      font-size: 13px;
    }
    .search input::placeholder{ color: var(--faint); }

    .actions{
      display:flex;
      align-items:center;
      gap: 10px;
    }
    .pill{
      display:flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: var(--card);
      color: var(--muted);
      cursor: pointer;
      transition: transform 0.15s ease, background 0.15s ease, border-color 0.15s ease;
      user-select:none;
    }
    .pill:hover{
      transform: translateY(-1px);
      background: var(--card2);
      border-color: var(--stroke2);
      color: var(--text);
    }
    .pill:active{ transform: translateY(0px) scale(0.99); }

    .pill.accent{
      background: linear-gradient(180deg, rgba(25,195,125,0.18), rgba(25,195,125,0.10));
      border-color: rgba(25,195,125,0.35);
      color: var(--text);
    }

    /* Layout */
    .wrap{
      max-width: var(--max);
      margin: 0 auto;
      padding: 18px;
      display:grid;
      grid-template-columns: 360px 1fr;
      gap: 18px;
    }

    @media (max-width: 980px){
      .wrap{ grid-template-columns: 1fr; }
      .brand{ min-width: auto; }
    }

    /* Left rail */
    .rail{
      position: sticky;
      top: 74px;
      align-self:start;
      display:flex;
      flex-direction: column;
      gap: 14px;
      height: calc(100vh - 92px);
      overflow: auto;
      padding-bottom: 8px;
    }
    @media (max-width: 980px){
      .rail{ position: static; height: auto; overflow: visible; }
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.03));
      border: 1px solid var(--stroke);
      border-radius: var(--radius2);
      box-shadow: var(--shadow2);
      overflow: hidden;
    }
    .panel .hd{
      padding: 14px 14px 10px 14px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
    }
    .panel .hd h3{
      margin:0;
      font-size: 13px;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      color: var(--muted);
    }
    .panel .bd{
      padding: 0 14px 14px 14px;
    }

    .statline{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .chip{
      border: 1px solid var(--stroke);
      background: var(--card);
      padding: 10px 12px;
      border-radius: 16px;
      min-width: 148px;
    }
    .chip .k{
      font-size: 11px;
      color: var(--faint);
      font-family: var(--mono);
    }
    .chip .v{
      margin-top: 6px;
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 0.2px;
    }
    .chip .v small{ color: var(--faint); font-weight: 500; }

    .filters{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .seg{
      display:flex;
      border: 1px solid var(--stroke);
      background: var(--card);
      border-radius: 999px;
      overflow: hidden;
    }
    .seg button{
      border: 0;
      background: transparent;
      color: var(--muted);
      padding: 10px 12px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.15s ease, color 0.15s ease;
    }
    .seg button.active{
      background: rgba(25,195,125,0.18);
      color: var(--text);
    }

    .note{
      margin-top: 10px;
      font-size: 12px;
      color: var(--faint);
      line-height: 1.45;
    }
    .note a{
      color: var(--text);
      border-bottom: 1px solid rgba(25,195,125,0.35);
    }

    /* Stories */
    .stories{
      display:flex;
      gap: 12px;
      overflow: auto;
      padding: 12px 14px 14px 14px;
      scrollbar-width: thin;
    }
    .story{
      min-width: 104px;
      max-width: 104px;
      display:flex;
      flex-direction: column;
      gap: 8px;
      cursor: pointer;
      user-select: none;
    }
    .story .ring{
      width: 72px;
      height: 72px;
      border-radius: 999px;
      padding: 2px;
      background: conic-gradient(from 90deg, rgba(25,195,125,0.95), rgba(25,195,125,0.25), rgba(255,255,255,0.35), rgba(25,195,125,0.95));
      box-shadow: var(--shadow2);
    }
    .story .thumb{
      width: 100%;
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.03));
      border: 1px solid rgba(255,255,255,0.16);
      overflow:hidden;
      position: relative;
    }
    .story img{
      width:100%;
      height:100%;
      object-fit: cover;
      filter: saturate(1.05) contrast(1.03);
      transform: scale(1.02);
    }
    .story .label{
      font-size: 12px;
      color: var(--muted);
      line-height: 1.15;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Feed */
    .feed{
      display:flex;
      flex-direction: column;
      gap: 14px;
      min-height: 60vh;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.03));
      border: 1px solid var(--stroke);
      border-radius: var(--radius2);
      overflow:hidden;
      box-shadow: var(--shadow2);
    }

    .card .meta{
      padding: 14px 14px 12px 14px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
    }

    .who{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }
    .avatar{
      width: 38px;
      height: 38px;
      border-radius: 14px;
      background:
        radial-gradient(14px 14px at 30% 30%, rgba(255,255,255,0.55), transparent 60%),
        radial-gradient(18px 18px at 70% 80%, rgba(25,195,125,0.45), transparent 60%),
        linear-gradient(135deg, rgba(255,255,255,0.10), rgba(255,255,255,0.02));
      border: 1px solid var(--stroke2);
      box-shadow: var(--shadow2);
      flex: 0 0 auto;
    }
    .who .names{
      min-width: 0;
      display:flex;
      flex-direction: column;
      gap: 2px;
    }
    .who .artist{
      font-size: 13px;
      font-weight: 650;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .who .subtitle{
      font-size: 12px;
      color: var(--faint);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-family: var(--mono);
    }

    .more{
      display:flex;
      gap: 8px;
      align-items:center;
      flex: 0 0 auto;
    }

    .iconbtn{
      width: 38px;
      height: 38px;
      border-radius: 14px;
      border: 1px solid var(--stroke);
      background: var(--card);
      display:grid;
      place-items:center;
      cursor:pointer;
      transition: transform 0.15s ease, background 0.15s ease, border-color 0.15s ease;
    }
    .iconbtn:hover{
      transform: translateY(-1px);
      background: var(--card2);
      border-color: var(--stroke2);
    }
    .iconbtn:active{ transform: translateY(0px) scale(0.99); }

    .media{
      position: relative;
      background: rgba(0,0,0,0.20);
      aspect-ratio: 4 / 3;
      overflow:hidden;
    }
    .media img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
      transform: scale(1.01);
      filter: saturate(1.05) contrast(1.04);
    }
    .media:after{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(700px 320px at 50% 110%, rgba(0,0,0,0.55), transparent 60%),
                  linear-gradient(to bottom, rgba(0,0,0,0.12), transparent 45%);
      pointer-events:none;
    }

    .badge{
      position:absolute;
      left: 14px;
      bottom: 14px;
      z-index:2;
      display:flex;
      gap: 10px;
      align-items:center;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(0,0,0,0.30);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: var(--shadow2);
      max-width: calc(100% - 28px);
    }
    .badge .title{
      font-size: 13px;
      font-weight: 650;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .badge .year{
      font-size: 12px;
      color: rgba(255,255,255,0.78);
      font-family: var(--mono);
      white-space: nowrap;
    }

    @media (prefers-color-scheme: light){
      .badge{
        background: rgba(255,255,255,0.66);
        border-color: rgba(17,24,39,0.14);
      }
      .badge .year{ color: rgba(17,24,39,0.62); }
    }

    .body{
      padding: 14px;
      display:flex;
      flex-direction: column;
      gap: 10px;
    }

    .cta-row{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .actions-row{
      display:flex;
      gap: 8px;
      align-items:center;
      flex-wrap: wrap;
    }
    .act{
      display:flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: var(--card);
      color: var(--muted);
      cursor:pointer;
      transition: transform 0.15s ease, background 0.15s ease, border-color 0.15s ease, color 0.15s ease;
      font-size: 12px;
    }
    .act:hover{
      transform: translateY(-1px);
      background: var(--card2);
      border-color: var(--stroke2);
      color: var(--text);
    }
    .act.primary{
      background: linear-gradient(180deg, rgba(25,195,125,0.20), rgba(25,195,125,0.10));
      border-color: rgba(25,195,125,0.35);
      color: var(--text);
    }
    .act.primary:hover{
      background: linear-gradient(180deg, rgba(25,195,125,0.26), rgba(25,195,125,0.14));
      border-color: rgba(25,195,125,0.50);
    }

    .desc{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.5;
    }
    .desc b{ color: var(--text); font-weight: 650; }

    .tags{
      display:flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .tag{
      font-size: 11px;
      color: var(--faint);
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,0.03);
      padding: 8px 10px;
      border-radius: 999px;
      font-family: var(--mono);
      user-select:none;
    }
    .tag.ac{
      border-color: rgba(25,195,125,0.35);
      background: rgba(25,195,125,0.10);
      color: rgba(25,195,125,0.95);
    }

    /* Skeleton */
    .skeleton{
      position: relative;
      overflow:hidden;
      background: rgba(255,255,255,0.04);
      border: 1px solid var(--stroke);
      border-radius: var(--radius2);
      height: 420px;
      box-shadow: var(--shadow2);
    }
    .skeleton:before{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.10), transparent);
      transform: translateX(-100%);
      animation: shimmer 1.2s infinite;
    }
    @keyframes shimmer{
      to{ transform: translateX(100%); }
    }

    /* Modal */
    .modal{
      position: fixed;
      inset:0;
      z-index: 50;
      display:none;
      place-items: center;
      padding: 20px;
      background: rgba(0,0,0,0.55);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    .modal.open{ display:grid; }
    .dialog{
      width: min(1020px, 96vw);
      max-height: min(86vh, 900px);
      overflow: hidden;
      border-radius: 28px;
      border: 1px solid var(--stroke2);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      box-shadow: 0 24px 80px rgba(0,0,0,0.50);
      display:grid;
      grid-template-columns: 1.2fr 0.8fr;
    }
    @media (max-width: 900px){
      .dialog{ grid-template-columns: 1fr; }
    }
    .dialog .img{
      background: rgba(0,0,0,0.18);
      position: relative;
      min-height: 320px;
    }
    .dialog .img img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }
    .dialog .side{
      padding: 16px;
      display:flex;
      flex-direction: column;
      gap: 12px;
      overflow:auto;
    }
    .close-row{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
    }
    .xbtn{
      width: 40px;
      height: 40px;
      border-radius: 14px;
      border: 1px solid var(--stroke);
      background: var(--card);
      cursor:pointer;
      display:grid;
      place-items:center;
    }
    .xbtn:hover{ border-color: var(--stroke2); background: var(--card2); }
    .h1{
      margin:0;
      font-size: 18px;
      letter-spacing: 0.2px;
      line-height: 1.25;
    }
    .byline{
      font-size: 13px;
      color: var(--muted);
    }
    .byline span{
      font-family: var(--mono);
      color: var(--faint);
      margin-left: 8px;
    }
    .facts{
      display:grid;
      gap: 10px;
      grid-template-columns: 1fr 1fr;
    }
    .fact{
      border: 1px solid var(--stroke);
      background: var(--card);
      border-radius: 18px;
      padding: 10px 12px;
    }
    .fact .k{ font-size: 11px; color: var(--faint); font-family: var(--mono); }
    .fact .v{ margin-top: 6px; font-size: 13px; color: var(--text); font-weight: 650; }
    .tiny{
      font-size: 12px;
      color: var(--faint);
      line-height: 1.45;
    }

    .footer{
      max-width: var(--max);
      margin: 0 auto;
      padding: 30px 18px 44px 18px;
      color: var(--faint);
      font-size: 12px;
      line-height: 1.55;
      display:flex;
      justify-content: space-between;
      gap: 18px;
      flex-wrap: wrap;
    }
    .footer .left strong{ color: var(--text); }
    .footer code{
      font-family: var(--mono);
      background: rgba(255,255,255,0.06);
      border: 1px solid var(--stroke);
      padding: 2px 6px;
      border-radius: 8px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand" role="banner" aria-label="The Collection">
        <div class="brand-mark" aria-hidden="true"></div>
        <div>
          <div class="brand-name">The Collection</div>
          <div class="brand-sub">art • provenance • discovery</div>
        </div>
      </div>

      <div class="search" role="search">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M10.5 18.5a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" stroke="currentColor" stroke-width="1.7"/>
          <path d="M16.5 16.5 21 21" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
        </svg>
        <input id="q" type="text" placeholder="Search artists, titles, mediums…" autocomplete="off" />
      </div>

      <div class="actions">
        <div class="pill" id="refreshBtn" title="Refresh selection">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M20 12a8 8 0 0 1-14.9 4" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
            <path d="M4 12A8 8 0 0 1 18.9 8" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
            <path d="M18.7 3.8v4.1h-4.1" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M5.3 20.2v-4.1h4.1" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Refresh
        </div>
        <div class="pill accent" id="curateBtn" title="Curate">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 21s-7-4.4-9.3-9A5.6 5.6 0 0 1 12 5.6 5.6 5.6 0 0 1 21.3 12c-2.3 4.6-9.3 9-9.3 9Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
          </svg>
          Curate
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- Left rail -->
    <aside class="rail">
      <section class="panel">
        <div class="hd">
          <h3>Curator’s Desk</h3>
          <div class="tag ac" title="Live from The Met API">LIVE</div>
        </div>
        <div class="bd">
          <div class="statline">
            <div class="chip">
              <div class="k">FEED</div>
              <div class="v"><span id="countLive">—</span> <small>works</small></div>
            </div>
            <div class="chip">
              <div class="k">SOURCE</div>
              <div class="v">The Met <small>Open Access</small></div>
            </div>
            <div class="chip">
              <div class="k">VIBE</div>
              <div class="v">Quiet Luxury</div>
            </div>
          </div>

          <div class="filters">
            <div class="seg" role="tablist" aria-label="Mode">
              <button class="active" data-mode="feed" role="tab">Feed</button>
              <button data-mode="grid" role="tab">Grid</button>
            </div>

            <div class="seg" role="tablist" aria-label="Curate">
              <button class="active" data-curate="icons" role="tab">Iconic</button>
              <button data-curate="painting" role="tab">Painting</button>
              <button data-curate="photo" role="tab">Photography</button>
            </div>
          </div>

          <p class="note">
            This prototype pulls artwork metadata + images from The Met’s public API at runtime.
            Use the search bar to filter the current selection locally.
          </p>
        </div>
      </section>

      <section class="panel">
        <div class="hd">
          <h3>Stories</h3>
          <div class="tag">tap to open</div>
        </div>
        <div class="stories" id="stories"></div>
      </section>

      <section class="panel">
        <div class="hd">
          <h3>Collection Notes</h3>
          <div class="tag">prototype</div>
        </div>
        <div class="bd">
          <div class="tiny">
            Design choices:
            <ul style="margin:10px 0 0 18px; padding:0; color: var(--muted);">
              <li>Minimal chrome, strong typography, soft glass panels.</li>
              <li>Instagram-ish rhythm: stories → feed → detail modal.</li>
              <li>Subtle green as “tasteful signal,” not loud branding.</li>
            </ul>
            <div style="margin-top:12px;">
              Tip: click any artwork to open a high-end detail view with metadata.
            </div>
          </div>
        </div>
      </section>
    </aside>

    <!-- Main feed -->
    <section class="feed" id="feed">
      <div class="skeleton"></div>
      <div class="skeleton"></div>
      <div class="skeleton"></div>
    </section>
  </main>

  <footer class="footer">
    <div class="left">
      <strong>The Collection</strong> • frontend prototype<br/>
      Live data: <code>collectionapi.metmuseum.org</code> (no auth). :contentReference[oaicite:1]{index=1}
    </div>
    <div class="right">
      Built for a high-end, art-collector feel: quiet, modern, and image-first.
    </div>
  </footer>

  <!-- Modal -->
  <div class="modal" id="modal" aria-hidden="true" role="dialog" aria-label="Artwork details">
    <div class="dialog">
      <div class="img">
        <img id="modalImg" alt="" />
      </div>
      <div class="side">
        <div class="close-row">
          <div class="tag ac" id="modalDept">—</div>
          <button class="xbtn" id="closeModal" aria-label="Close">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M6 6l12 12M18 6 6 18" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
            </svg>
          </button>
        </div>

        <h2 class="h1" id="modalTitle">—</h2>
        <div class="byline" id="modalByline">— <span id="modalYear">—</span></div>

        <div class="facts">
          <div class="fact"><div class="k">MEDIUM</div><div class="v" id="modalMedium">—</div></div>
          <div class="fact"><div class="k">CULTURE</div><div class="v" id="modalCulture">—</div></div>
          <div class="fact"><div class="k">PERIOD</div><div class="v" id="modalPeriod">—</div></div>
          <div class="fact"><div class="k">DIMENSIONS</div><div class="v" id="modalDims">—</div></div>
        </div>

        <div class="cta-row">
          <div class="actions-row">
            <button class="act primary" id="saveBtn">
              <svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M6 3h12a2 2 0 0 1 2 2v16l-8-4-8 4V5a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
              </svg>
              Save
            </button>
            <button class="act" id="shareBtn">
              <svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M12 16V4" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                <path d="M7 9l5-5 5 5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4 20h16" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
              </svg>
              Share
            </button>
            <a class="act" id="metLink" href="#" target="_blank" rel="noreferrer">
              <svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M14 3h7v7" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                <path d="M10 14 21 3" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                <path d="M21 14v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h6" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
              </svg>
              View at The Met
            </a>
          </div>
        </div>

        <p class="tiny" id="modalNote">
          — 
        </p>
      </div>
    </div>
  </div>

  <script>
    // The Met Collection API (public, no key)
    // Docs: https://metmuseum.github.io/  (referenced in footer text)
    const API = "https://collectionapi.metmuseum.org/public/collection/v1";

    const el = (id) => document.getElementById(id);
    const feedEl = el("feed");
    const storiesEl = el("stories");
    const qEl = el("q");
    const countLiveEl = el("countLive");

    const refreshBtn = el("refreshBtn");
    const curateBtn = el("curateBtn");

    const modal = el("modal");
    const closeModal = el("closeModal");

    // modal fields
    const modalImg = el("modalImg");
    const modalTitle = el("modalTitle");
    const modalByline = el("modalByline");
    const modalYear = el("modalYear");
    const modalDept = el("modalDept");
    const modalMedium = el("modalMedium");
    const modalCulture = el("modalCulture");
    const modalPeriod = el("modalPeriod");
    const modalDims = el("modalDims");
    const modalNote = el("modalNote");
    const metLink = el("metLink");
    const saveBtn = el("saveBtn");
    const shareBtn = el("shareBtn");

    let mode = "feed";        // feed | grid
    let curate = "icons";     // icons | painting | photo
    let allItems = [];
    let saved = new Set(JSON.parse(localStorage.getItem("thecollection_saved") || "[]"));

    function setSavedStorage(){
      localStorage.setItem("thecollection_saved", JSON.stringify([...saved]));
    }

    function icon(name){
      const icons = {
        heart: `<svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 21s-7-4.4-9.3-9A5.6 5.6 0 0 1 12 5.6 5.6 5.6 0 0 1 21.3 12c-2.3 4.6-9.3 9-9.3 9Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
        </svg>`,
        spark: `<svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 2l1.2 5.1L18 9l-4.8 1.9L12 16l-1.2-5.1L6 9l4.8-1.9L12 2Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
          <path d="M19 14l.7 2.8L22 18l-2.3 1.2L19 22l-.7-2.8L16 18l2.3-1.2L19 14Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
        </svg>`,
        bookmark: `<svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M6 3h12a2 2 0 0 1 2 2v16l-8-4-8 4V5a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
        </svg>`,
        grid: `<svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M4 4h7v7H4V4Zm9 0h7v7h-7V4ZM4 13h7v7H4v-7Zm9 0h7v7h-7v-7Z" stroke="currentColor" stroke-width="1.7" stroke-linejoin="round"/>
        </svg>`
      };
      return icons[name] || "";
    }

    function clean(s){
      return (s || "").toString().trim() || "—";
    }

    function shortList(arr, n=3){
      if (!Array.isArray(arr)) return [];
      return arr.filter(Boolean).slice(0, n).map(t => t.term || t).filter(Boolean);
    }

    function pickQuery(){
      // Lightweight “curation” by search term + optional medium bias
      if (curate === "photo") return { q: "photograph", title: false };
      if (curate === "painting") return { q: "painting", title: false };
      // iconic-ish: mix a bit
      const options = ["portrait", "landscape", "still life", "mythology", "impressionism", "renaissance", "modern", "drawing"];
      return { q: options[Math.floor(Math.random()*options.length)], title: false };
    }

    async function fetchJSON(url){
      const res = await fetch(url);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return res.json();
    }

    function shuffle(a){
      const arr = [...a];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function setSegActive(segEl, valueAttr, value){
      segEl.querySelectorAll("button").forEach(b => {
        b.classList.toggle("active", b.getAttribute(valueAttr) === value);
      });
    }

    function renderSkeleton(){
      feedEl.innerHTML = `
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
      `;
    }

    function renderStories(items){
      const top = items.slice(0, 10);
      storiesEl.innerHTML = top.map((it, idx) => `
        <div class="story" data-id="${it.objectID}" title="Open details">
          <div class="ring">
            <div class="thumb">
              <img loading="lazy" src="${it.primaryImageSmall}" alt="${escapeHtml(it.title)} by ${escapeHtml(it.artistDisplayName || "Unknown")}" />
            </div>
          </div>
          <div class="label">${escapeHtml(it.artistDisplayName || it.culture || "Unknown")}</div>
        </div>
      `).join("");

      storiesEl.querySelectorAll(".story").forEach(node => {
        node.addEventListener("click", () => {
          const id = node.getAttribute("data-id");
          const item = allItems.find(x => String(x.objectID) === String(id));
          if (item) openModal(item);
        });
      });
    }

    function renderFeed(items){
      countLiveEl.textContent = items.length;

      if (mode === "grid"){
        // Grid mode: image-first with light meta overlay
        feedEl.innerHTML = `
          <div class="card" style="padding:14px;">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;">
              <div style="display:flex; align-items:center; gap:10px;">
                <div class="tag ac">GRID</div>
                <div style="color:var(--muted); font-size:13px;">A quick look at today’s selection.</div>
              </div>
              <button class="act" id="backToFeed">${icon("grid")} Back to feed</button>
            </div>
            <div style="margin-top:14px; display:grid; grid-template-columns:repeat(3, 1fr); gap:10px;">
              ${items.map(it => `
                <a href="#" class="gridItem" data-id="${it.objectID}" style="
                  position:relative; border-radius:18px; overflow:hidden; border:1px solid var(--stroke);
                  background:rgba(0,0,0,0.18); aspect-ratio:1/1; display:block;">
                  <img loading="lazy" src="${it.primaryImageSmall}" alt="${escapeHtml(it.title)}" style="width:100%; height:100%; object-fit:cover; display:block; filter:saturate(1.05) contrast(1.03);" />
                  <div style="
                    position:absolute; inset:auto 10px 10px 10px;
                    padding:10px 10px;
                    border-radius:16px;
                    background:rgba(0,0,0,0.30);
                    border:1px solid rgba(255,255,255,0.14);
                    backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
                    color:rgba(255,255,255,0.92);
                    font-size:12px;
                    box-shadow: var(--shadow2);
                    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
                  ">
                    ${escapeHtml(it.title || "Untitled")}
                  </div>
                </a>
              `).join("")}
            </div>
          </div>
        `;

        const backBtn = el("backToFeed");
        backBtn?.addEventListener("click", (e) => {
          e.preventDefault();
          mode = "feed";
          document.querySelectorAll('[data-mode]').forEach(b => b.classList.toggle("active", b.dataset.mode === mode));
          renderFeed(items);
        });

        feedEl.querySelectorAll(".gridItem").forEach(a => {
          a.addEventListener("click", (e) => {
            e.preventDefault();
            const id = a.getAttribute("data-id");
            const item = allItems.find(x => String(x.objectID) === String(id));
            if (item) openModal(item);
          });
        });
        return;
      }

      // Feed mode
      feedEl.innerHTML = items.map((it) => {
        const artist = clean(it.artistDisplayName) !== "—" ? it.artistDisplayName : (it.culture || "Unknown");
        const sub = [it.objectName, it.department].filter(Boolean).join(" • ") || "—";
        const year = it.objectDate || it.accessionYear || "—";
        const tags = [
          it.department,
          it.culture,
          it.period,
          it.medium && (it.medium.length > 26 ? it.medium.slice(0, 26) + "…" : it.medium),
          ...shortList(it.tags, 2)
        ].filter(Boolean).slice(0, 5);

        const isSaved = saved.has(String(it.objectID));
        return `
          <article class="card" data-id="${it.objectID}">
            <div class="meta">
              <div class="who">
                <div class="avatar" aria-hidden="true"></div>
                <div class="names">
                  <div class="artist">${escapeHtml(artist)}</div>
                  <div class="subtitle">${escapeHtml(sub)}</div>
                </div>
              </div>
              <div class="more">
                <button class="iconbtn" data-action="spark" title="Curator note">${icon("spark")}</button>
                <button class="iconbtn" data-action="open" title="Open">${dotsIcon()}</button>
              </div>
            </div>

            <div class="media" role="button" tabindex="0" aria-label="Open artwork">
              <img loading="lazy" src="${it.primaryImageSmall}" alt="${escapeHtml(it.title)}" />
              <div class="badge">
                <div class="title">${escapeHtml(it.title || "Untitled")}</div>
                <div class="year">${escapeHtml(String(year))}</div>
              </div>
            </div>

            <div class="body">
              <div class="cta-row">
                <div class="actions-row">
                  <button class="act ${isSaved ? "primary" : ""}" data-action="save">
                    ${icon("bookmark")}
                    ${isSaved ? "Saved" : "Save"}
                  </button>
                  <button class="act" data-action="share">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                      <path d="M12 16V4" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                      <path d="M7 9l5-5 5 5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M4 20h16" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                    </svg>
                    Share
                  </button>
                  <a class="act" href="${escapeAttr(it.objectURL || "#")}" target="_blank" rel="noreferrer">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                      <path d="M14 3h7v7" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                      <path d="M10 14 21 3" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                      <path d="M21 14v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h6" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                    </svg>
                    The Met
                  </a>
                </div>
                <div class="tag ac" title="Prototype: taste score">▲ High signal</div>
              </div>

              <p class="desc">
                <b>${escapeHtml(it.title || "Untitled")}</b> by <b>${escapeHtml(clean(it.artistDisplayName) !== "—" ? it.artistDisplayName : "Unknown")}</b>.
                ${escapeHtml(buildOneLiner(it))}
              </p>

              <div class="tags">
                ${tags.map((t,i) => `<span class="tag ${i===0 ? "ac":""}">${escapeHtml(t)}</span>`).join("")}
              </div>
            </div>
          </article>
        `;
      }).join("");

      // Wire interactions
      feedEl.querySelectorAll(".card").forEach(card => {
        const id = card.getAttribute("data-id");
        const item = allItems.find(x => String(x.objectID) === String(id));
        const media = card.querySelector(".media");
        media?.addEventListener("click", () => item && openModal(item));
        media?.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") { e.preventDefault(); item && openModal(item); }
        });

        card.querySelectorAll("[data-action]").forEach(btn => {
          btn.addEventListener("click", (e) => {
            e.preventDefault();
            e.stopPropagation();
            const action = btn.getAttribute("data-action");
            if (!item) return;
            if (action === "save") toggleSave(item, btn);
            if (action === "share") shareItem(item);
            if (action === "open") openModal(item);
            if (action === "spark") toast(`Curator note: ${curatorNote(item)}`);
          });
        });
      });
    }

    function buildOneLiner(it){
      const parts = [];
      if (it.medium) parts.push(it.medium);
      if (it.culture) parts.push(it.culture);
      if (it.period) parts.push(it.period);
      const p = parts.filter(Boolean).slice(0,3).join(" • ");
      if (!p) return "A strong piece with collector energy.";
      return `${p}.`;
    }

    function curatorNote(it){
      const pick = [
        "Unusually calm composition, but the details keep pulling you in.",
        "The kind of work that anchors a room without shouting.",
        "There’s a quiet confidence here. Strong collector taste.",
        "Feels like a piece you’d build a wall around.",
        "A great example of how restraint can be the whole point."
      ];
      if ((it.medium || "").toLowerCase().includes("photograph")) return "Photographic, but still sculptural in its presence. A smart wall moment.";
      return pick[Math.floor(Math.random()*pick.length)];
    }

    function toast(msg){
      const t = document.createElement("div");
      t.textContent = msg;
      t.style.position = "fixed";
      t.style.left = "50%";
      t.style.bottom = "26px";
      t.style.transform = "translateX(-50%)";
      t.style.padding = "12px 14px";
      t.style.borderRadius = "999px";
      t.style.border = "1px solid rgba(255,255,255,0.16)";
      t.style.background = "rgba(0,0,0,0.35)";
      t.style.backdropFilter = "blur(12px)";
      t.style.webkitBackdropFilter = "blur(12px)";
      t.style.boxShadow = "0 18px 50px rgba(0,0,0,0.45)";
      t.style.color = "rgba(255,255,255,0.92)";
      t.style.fontSize = "12px";
      t.style.maxWidth = "min(680px, 92vw)";
      t.style.whiteSpace = "nowrap";
      t.style.overflow = "hidden";
      t.style.textOverflow = "ellipsis";
      t.style.zIndex = "80";
      document.body.appendChild(t);
      setTimeout(()=>{ t.style.opacity = "0"; t.style.transition = "opacity 180ms ease"; }, 1800);
      setTimeout(()=>{ t.remove(); }, 2100);
    }

    function toggleSave(item, btn){
      const key = String(item.objectID);
      if (saved.has(key)) saved.delete(key);
      else saved.add(key);
      setSavedStorage();
      btn.classList.toggle("primary", saved.has(key));
      btn.innerHTML = `${icon("bookmark")} ${saved.has(key) ? "Saved" : "Save"}`;
      toast(saved.has(key) ? "Saved to your collection." : "Removed from saved.");
    }

    async function shareItem(item){
      const url = item.objectURL || "";
      const title = item.title || "Artwork";
      const artist = item.artistDisplayName || "Unknown";
      const text = `${title} — ${artist}`;
      try{
        if (navigator.share){
          await navigator.share({ title: "The Collection", text, url });
        }else{
          await navigator.clipboard.writeText(url || text);
          toast(url ? "Link copied." : "Copied.");
        }
      }catch(e){
        // user cancelled or clipboard blocked
        toast("Couldn’t share here, but the idea is wired.");
      }
    }

    function openModal(item){
      modal.classList.add("open");
      modal.setAttribute("aria-hidden", "false");

      modalImg.src = item.primaryImage || item.primaryImageSmall;
      modalImg.alt = `${item.title || "Untitled"} by ${item.artistDisplayName || "Unknown"}`;

      modalDept.textContent = clean(item.department);
      modalTitle.textContent = clean(item.title);

      const artist = clean(item.artistDisplayName) !== "—" ? item.artistDisplayName : "Unknown";
      modalByline.textContent = artist;

      modalYear.textContent = clean(item.objectDate || item.accessionYear);

      modalMedium.textContent = clean(item.medium);
      modalCulture.textContent = clean(item.culture);
      modalPeriod.textContent = clean(item.period || item.dynasty);
      modalDims.textContent = clean(item.dimensions);

      metLink.href = item.objectURL || "#";

      const s = saved.has(String(item.objectID));
      saveBtn.textContent = s ? "Saved" : "Save";
      saveBtn.classList.toggle("primary", s);

      const noteBits = [];
      if (item.creditLine) noteBits.push(item.creditLine);
      if (item.repository) noteBits.push(item.repository);
      if (item.city || item.country) noteBits.push([item.city, item.country].filter(Boolean).join(", "));
      modalNote.textContent = noteBits.filter(Boolean).slice(0,3).join(" • ") || "A high-end prototype detail view.";

      // buttons
      saveBtn.onclick = () => {
        const key = String(item.objectID);
        if (saved.has(key)) saved.delete(key); else saved.add(key);
        setSavedStorage();
        const now = saved.has(key);
        saveBtn.textContent = now ? "Saved" : "Save";
        saveBtn.classList.toggle("primary", now);
        toast(now ? "Saved to your collection." : "Removed from saved.");
        // reflect in feed if visible
        const cardBtn = document.querySelector(`.card[data-id="${item.objectID}"] [data-action="save"]`);
        if (cardBtn) {
          cardBtn.classList.toggle("primary", now);
          cardBtn.innerHTML = `${icon("bookmark")} ${now ? "Saved" : "Save"}`;
        }
      };
      shareBtn.onclick = () => shareItem(item);
    }

    function closeIt(){
      modal.classList.remove("open");
      modal.setAttribute("aria-hidden", "true");
      modalImg.src = "";
    }

    closeModal.addEventListener("click", closeIt);
    modal.addEventListener("click", (e) => { if (e.target === modal) closeIt(); });
    window.addEventListener("keydown", (e) => { if (e.key === "Escape" && modal.classList.contains("open")) closeIt(); });

    function escapeHtml(str){
      return String(str ?? "").replace(/[&<>"']/g, (m)=>({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[m]));
    }
    function escapeAttr(str){ return escapeHtml(str).replace(/"/g, "&quot;"); }
    function dotsIcon(){
      return `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M5 12h.01M12 12h.01M19 12h.01" stroke="currentColor" stroke-width="3.2" stroke-linecap="round"/>
      </svg>`;
    }

    function applySearch(){
      const term = qEl.value.trim().toLowerCase();
      if (!term) { renderStories(allItems); renderFeed(allItems); return; }
      const filtered = allItems.filter(it => {
        const hay = [
          it.title, it.artistDisplayName, it.medium, it.department, it.culture, it.period, it.objectName
        ].filter(Boolean).join(" ").toLowerCase();
        return hay.includes(term);
      });
      renderStories(filtered);
      renderFeed(filtered);
    }

    qEl.addEventListener("input", () => applySearch());

    document.querySelectorAll("[data-mode]").forEach(b => {
      b.addEventListener("click", () => {
        mode = b.dataset.mode;
        setSegActive(b.parentElement, "data-mode", mode);
        applySearch();
      });
    });

    document.querySelectorAll("[data-curate]").forEach(b => {
      b.addEventListener("click", () => {
        curate = b.dataset.curate;
        setSegActive(b.parentElement, "data-curate", curate);
        load();
      });
    });

    refreshBtn.addEventListener("click", () => load());
    curateBtn.addEventListener("click", () => {
      toast("Curating a fresh pull from The Met…");
      load();
    });

    async function load(){
      renderSkeleton();
      try{
        const { q } = pickQuery();

        // Search returns objectIDs; despite hasImages=true, some objects may still lack image URLs,
        // so we filter after fetching objects (see: known issue discussions in the ecosystem).
        const searchUrl = `${API}/search?hasImages=true&q=${encodeURIComponent(q)}`;
        const search = await fetchJSON(searchUrl);

        const ids = shuffle((search.objectIDs || []).slice(0, 240));
        const items = [];

        // Gather ~20 objects with usable images
        for (let i = 0; i < ids.length && items.length < 20; i++){
          const id = ids[i];
          try{
            const obj = await fetchJSON(`${API}/objects/${id}`);
            const img = obj.primaryImageSmall || obj.primaryImage;
            if (!img) continue;
            items.push(obj);
          }catch(_e){ /* skip */ }
        }

        allItems = items;
        renderStories(allItems);
        renderFeed(allItems);
        applySearch();
      }catch(e){
        feedEl.innerHTML = `
          <div class="card" style="padding:18px;">
            <div class="tag ac">Error</div>
            <div style="margin-top:10px; color:var(--muted);">
              Couldn’t load The Met API right now. Refresh the page to try again.
            </div>
            <div class="tiny" style="margin-top:10px;">${escapeHtml(String(e.message || e))}</div>
          </div>
        `;
      }
    }

    // Kick off
    load();
  </script>
</body>
</html>